\documentclass{article}
\usepackage{mathtools} 
\usepackage{fontspec}
\usepackage[UTF8]{ctex}
\usepackage{amsthm}
\usepackage{mdframed}
\usepackage{xcolor}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{hyperref}


% 定义新的带灰色背景的说明环境 zremark
\newmdtheoremenv[
  backgroundcolor=gray!10,
  % 边框与背景一致，边框线会消失
  linecolor=gray!10
]{zremark}{注释}

% 通用矩阵命令: \flexmatrix{矩阵名}{元素符号}{行数}{列数}
\newcommand{\flexmatrix}[4]{
  \[
  #1 = \begin{pmatrix}
    #2_{11}     & #2_{12}     & \cdots & #2_{1#4}   \\
    #2_{21}     & #2_{22}     & \cdots & #2_{2#4}   \\
    \vdots      & \vdots      & \ddots & \vdots     \\
    #2_{#31}    & #2_{#32}    & \cdots & #2_{#3#4}
  \end{pmatrix}
  \]
}

% 简化版命令（默认矩阵名为A，元素符号为a）: \quickmatrix{行数}{列数}
\newcommand{\quickmatrix}[2]{\flexmatrix{A}{a}{#1}{#2}}


\begin{document}
\title{2.5}
\author{张志聪}
\maketitle

\section*{1}

\begin{itemize}
  \item (3)

        归纳法。通过计算有限次，找到规律。

  \item (4)

        归纳法。

  \item (5)

        尝试计算：
        \begin{align*}
          \begin{bmatrix}
            1  & -1 & -1 & -1 \\
            -1 & 1  & -1 & -1 \\
            -1 & -1 & 1  & -1 \\
            -1 & -1 & -1 & 1
          \end{bmatrix}
          \begin{bmatrix}
            1  & -1 & -1 & -1 \\
            -1 & 1  & -1 & -1 \\
            -1 & -1 & 1  & -1 \\
            -1 & -1 & -1 & 1
          \end{bmatrix}
          =
          \begin{bmatrix}
            4 & 0 & 0 & 0 \\
            0 & 4 & 0 & 0 \\
            0 & 0 & 4 & 0 \\
            0 & 0 & 0 & 4
          \end{bmatrix}
        \end{align*}

  \item (6)

        二项式定理。
        把需要计算的矩阵写作
        \begin{align*}
          (A + B)^n
          = A^n + C_n^1 A^{n - 1}B +  + C_n^2 A^{n - 2}B^{2} + \cdots + B^n
        \end{align*}
        注意以上二项式定理成立有前提：
        \begin{align*}
          AB = BA
        \end{align*}
\end{itemize}


\section*{6}

因为$A$与数域$K$上的所有$n$阶方阵都可交换，
特别地$n$阶方阵是对角矩阵，
于是由习题5可知，$A$是对角矩阵。

再利用习题4，与$J$类型的矩阵可交换的$A$，主对角线上元素相等。

综上可得，$A$是数量矩阵。

\section*{7}

\begin{itemize}
  \item (1)

        \begin{align*}
          (A + E) (A - E)
           & = A^2 - AE + EA - E^2 \\
           & = E - A + A - E       \\
           & = 0
        \end{align*}
        于是
        \begin{align*}
          rank[(A + E)(A - E)] = 0 & \geq rank(A + E) + rank(A - E) - n \\
          n                        & \geq rank(A + E) + rank(A - E)
        \end{align*}

        我们有
        \begin{align*}
          rank(A + E) + rank(A - E) & = rank(A + E) + rank(E - A)             \\
                                    & \geq rank(A + E + E - A) = rank(2E) = n
        \end{align*}
        综上
        \begin{align*}
          rank(A + E) + rank(A - E) = n
        \end{align*}

  \item (2)

        与(1)类似。

\end{itemize}

\section*{9}

\begin{align*}
  rank(A_1 A_2 \cdots A_k)
   & \geq rank(A_1) + rank(A_2 \cdots A_k) - n                       \\
   & \geq rank(A_1) + [rank(A_2) + rank(A_3 A_4 \cdots A_k) - n] - n \\
   & \geq \vdots                                                     \\
   & \geq rank(A_1) + rank(A_2) + \cdots + rank(A_k) - (k - 1)n
\end{align*}
因为
\begin{align*}
  A_1 A_2 \cdots A_k = 0
\end{align*}
所以
\begin{align*}
  rank(A_1 A_2 \cdots A_k) = 0
\end{align*}
综上可得
\begin{align*}
  0 \geq rank(A_1) + rank(A_2) + \cdots + rank(A_k) - (k - 1)n \\
  rank(A_1) + rank(A_2) + \cdots + rank(A_k) \leq (k - 1)n
\end{align*}

\section*{14}

\begin{itemize}
  \item (2)
        \begin{align*}
          B^{-1} = \frac{1}{n}\begin{bmatrix}
                                1      & 1                   & 1                    & 1                    & \cdots & 1                     \\
                                1      & \epsilon^{-1}       & \epsilon^{-2}        & \epsilon^{-3}        & \cdots & \epsilon^{-(n - 1)}   \\
                                1      & \epsilon^{-2}       & \epsilon^{-4}        & \epsilon^{-6}        & \cdots & \epsilon^{-2(n-1)}    \\
                                1      & \epsilon^{-3}       & \epsilon^{-6}        & \epsilon^{-9}        & \cdots & \epsilon^{-3(n-1)}    \\
                                \vdots & \vdots              & \vdots               & \vdots               & \cdots & \vdots                \\
                                1      & \epsilon^{-(n - 1)} & \epsilon^{-2(n - 1)} & \epsilon^{-3(n - 1)} & \cdots & \epsilon^{-(n - 1)^2}
                              \end{bmatrix}
        \end{align*}
        为验证$BB^{-1} = E$，我们验证$E$的$\beta_i(1 \leq i \leq n)$列向量。
        通过矩阵乘法可得
        \begin{align*}
          \beta_{ii} & = \frac{1}{n} (1 \cdot 1
          + \epsilon^{i-1} \epsilon^{-(i - 1)}
          + \epsilon^{(i-1)2} \epsilon^{-(i-1)2}
          + \epsilon^{(i-1)3} \epsilon^{-(i-1)3}
          + \cdots + \epsilon^{(i-1)(n - 1)} \epsilon^{-(i-1)(n - 1)}) \\
                     & = 1
        \end{align*}
        另外$i \neq j (1 \leq j \leq n)$时，利用第一章$\S 2$习题9，
        \begin{align*}
          \beta_{ij} & = \frac{1}{n} (1 \cdot 1
          + \epsilon^{i-1} \epsilon^{-(j - 1)}
          + \epsilon^{(i-1)2} \epsilon^{-(j-1)2}
          + \epsilon^{(i-1)3} \epsilon^{-(j-1)3}
          + \cdots + \epsilon^{(i-1)(n - 1)} \epsilon^{-(j-1)(n - 1)})                                                                  \\
                     & = \frac{1}{n}(1 + \epsilon^{i-j} + \epsilon^{2(i - j)} + \epsilon^{3(i - j)} + \cdots + \epsilon^{(n-1)(i - j)}) \\
                     & = \frac{1}{n} \cdot 0                                                                                            \\
                     & = 0
        \end{align*}
\end{itemize}

\section*{16}

提示
\begin{itemize}
  \item 方法一（整体）：通过对角矩阵$A^T = A$。

        \begin{itemize}
          \item 必要性

                已知，$AB$是对称矩阵和$A,B$是对称矩阵，那么
                \begin{align*}
                  AB = (AB)^T = B^T A^T = B A
                \end{align*}
          \item 充分性

                已知，$AB = BA$，我们有
                \begin{align*}
                  (AB)^T = (BA)^T
                \end{align*}
                又
                \begin{align*}
                  (BA)^T = A^T B^T = A B
                \end{align*}
                综上可得
                \begin{align*}
                  (AB)^T = AB
                \end{align*}
                所以，$AB$是对称矩阵。
        \end{itemize}

  \item 方法二（部分）：通过对角矩阵的元素性质$a_{ij} = a_{ji}$证明。

        这个就是矩阵乘法的计算，过程略。
\end{itemize}

\section*{18}

\begin{itemize}
  \item (2)

        设任意上三角矩阵
        \begin{align*}
          A = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                0      & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                0      & 0      & \cdots & a_{nn}
              \end{bmatrix}
        \end{align*}
        $A$是可逆的，由习题22可知，主对角线上的元素全不为零（做了增强，具体看习题的解答）。

        我们考虑计算$A$的逆矩阵。
        \begin{align*}
          (A \vert E) =
          \begin{bmatrix}
            a_{11} & a_{12} & \cdots & a_{1n} \\
            0      & a_{22} & \cdots & a_{2n} \\
            \vdots & \vdots & \ddots & \vdots \\
            0      & 0      & \cdots & a_{nn}
          \end{bmatrix}
          \begin{bmatrix}
            1      & 0      & \cdots & 0 \\
            0      & 1      & \cdots & 0 \\
            \vdots & \vdots & \ddots & 0 \\
            0      & 0      & \cdots & 1
          \end{bmatrix} \\
          \xrightarrow{}
          \begin{bmatrix}
            1      & a_{12} & \cdots & a_{1n} \\
            0      & 1      & \cdots & a_{2n} \\
            \vdots & \vdots & \ddots & \vdots \\
            0      & 0      & \cdots & 1
          \end{bmatrix}
          \begin{bmatrix}
            *      & 0      & \cdots & 0 \\
            0      & *      & \cdots & 0 \\
            \vdots & \vdots & \ddots & 0 \\
            0      & 0      & \cdots & *
          \end{bmatrix} \\
          \xrightarrow{}
          \begin{bmatrix}
            1      & 0      & \cdots & 0 \\
            0      & 1      & \cdots & 0 \\
            \vdots & \vdots & \ddots & 0 \\
            0      & 0      & \cdots & 1
          \end{bmatrix}
          \begin{bmatrix}
            *      & *      & \cdots & * \\
            0      & *      & \cdots & * \\
            \vdots & \vdots & \ddots & * \\
            0      & 0      & \cdots & *
          \end{bmatrix}
        \end{align*}
        先把主对角线上的元素变成1，然后把非主对角线上方的元素变成0，
        可得$A^{-1}$是上三角矩阵。
\end{itemize}

\section*{22}

这道题的反方向也是成立的。即上（下）三角矩阵主对角线元素全不为零当且仅当矩阵可逆。

\begin{itemize}
  \item (1) 必要性

        直观上，三角矩阵就已经是阶梯型矩阵了，主对角线上全不为零，矩阵就是满秩的，于是可逆的。

        严格证明，设任意矩阵上三角矩阵
        \begin{align*}
          A = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                0      & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                0      & 0      & \cdots & a_{nn}
              \end{bmatrix}
        \end{align*}
        其中$a_{ii} \neq 0 (1 \leq i \leq n)$。

        我们需要证明$A$是满秩的，即$A x = 0$只有零解。
        我们设
        \begin{align*}
          A = \begin{bmatrix}
                \alpha_1^T \\
                \alpha_2^T \\
                \vdots     \\
                \alpha_n^T
              \end{bmatrix},
          x = \begin{bmatrix}
                x_1    \\
                x_2    \\
                \vdots \\
                x_n
              \end{bmatrix}
        \end{align*}
        我们有
        \begin{align*}
          \alpha_n^T x                                    & = 0 \\
          0 \cdot x_1 + 0 \cdot x_2 + \cdots + a_{nn} x_n & = 0 \\
          a_{nn}x_n                                       & = 0 \\
          x_n                                             & = 0
        \end{align*}
        同理，我们有
        \begin{align*}
          \alpha_{n-1}^T x                                                               & = 0 \\
          0 \cdot x_1 + 0 \cdot x_2 + \cdots + a_{{n-1}{n-1}} x_{n-1} + a_{{n-1}{n}} x_n & = 0 \\
          a_{{n-1}{n-1}} x_{n-1} + a_{{n-1}{n}} x_n                                      & = 0
        \end{align*}
        由于$x_n = 0$，代入后，我们有
        \begin{align*}
          a_{{n-1}{n-1}} x_{n-1} & = 0 \\
          x_{n - 1}              & = 0
        \end{align*}
        以此类推，我们有
        \begin{align*}
          x_1 = x_2 = \cdots = x_n = 0
        \end{align*}
        于是
        \begin{align*}
          x = 0
        \end{align*}
        由以上推理可得$Ax$只有零解，于是$A$中的列向量是线性无关的，于是可得$rank(A) = n$，
        即$A$是满秩的，
        从而$A$是可逆的。

  \item (2) 充分性

        证明其逆否命题：上（下）三角矩阵主对角线存在零元素时，矩阵不可逆。

        设任意矩阵上三角矩阵
        \begin{align*}
          A = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                0      & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                0      & 0      & \cdots & a_{nn}
              \end{bmatrix}
        \end{align*}
        主对角线上，第一个零元素为$a_{kk} = 0 (1 \leq k \leq n)$。

        考虑矩阵
        \begin{align*}
          A_1 = \begin{bmatrix}
                  a_{11} & a_{12} & \cdots & a_{1(k-1)}     & a_{1k}     \\
                  0      & a_{22} & \cdots & a_{2(k-1)}     & a_{2k}     \\
                  \vdots & \vdots & \ddots & \vdots         & \vdots     \\
                  0      & 0      & \cdots & a_{(k-1)(k-1)} & a_{(k-1)k}
                \end{bmatrix}
        \end{align*}
        这是$A$矩阵的一部分，是一个$(k - 1) \times k$的矩阵，由矩阵的列秩与行秩相等可得，它的列向量一定是线性相关的。
        由于在$A$中，这些列向量的下方都是元素$0$，于是可得$A$中这些列向量也是线性相关的。
        于是可得$A$中列向量的秩小于$n$，可得$A$不是满秩的，从而$A$不可逆。
\end{itemize}

\section*{23}

\begin{itemize}
  \item (1)

        设$A, B$为任意$n$阶方阵
        \begin{align*}
          A = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                a_{21} & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                a_{n1} & a_{n2} & \cdots & a_{nn}
              \end{bmatrix} \\
          B = \begin{bmatrix}
                b_{11} & b_{12} & \cdots & b_{1n} \\
                b_{21} & b_{22} & \cdots & b_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                b_{n1} & b_{n2} & \cdots & b_{nn}
              \end{bmatrix}
        \end{align*}
        设$AB = C = (c_{ij}), BA = D = (d_{ij})$，我们有
        \begin{align*}
          Tr(AB) & = c_{11} + c_{22} + \cdots + c_{nn}                                       \\
                 & = \sum\limits_{k = 1}^n a_{1k}b_{k1} + \sum\limits_{k = 1}^n a_{2k}b_{k2}
          + \cdots + \sum\limits_{k = 1}^n a_{nk}b_{kn}                                      \\
                 & = \sum \limits_{l = 1}^n \sum\limits_{k = 1}^n a_{lk}b_{kl}
        \end{align*}
        \begin{align*}
          Tr(BA) & = d_{11} + d_{22} + \cdots + d_{nn}                                       \\
                 & = \sum\limits_{k = 1}^n b_{1k}a_{k1} + \sum\limits_{k = 1}^n b_{2k}a_{k2}
          + \cdots + \sum\limits_{k = 1}^n b_{nk}a_{kn}                                      \\
                 & = \sum \limits_{l = 1}^n \sum\limits_{k = 1}^n b_{lk}a_{kl}
        \end{align*}
        于是，只需证明$\sum \limits_{l = 1}^n \sum\limits_{k = 1}^n a_{lk}b_{kl} = \sum \limits_{l = 1}^n \sum\limits_{k = 1}^n b_{lk}a_{kl}$。

        对$n$进行归纳。

        $n = 1$时，
        \begin{align*}
          \sum \limits_{l = 1}^1 \sum\limits_{k = 1}^1 a_{lk}b_{kl}
           & = a_{11}b_{11}                                              \\
           & = \sum \limits_{l = 1}^1 \sum\limits_{k = 1}^1 b_{lk}a_{kl}
        \end{align*}
        等式成立。

        归纳假设$n = r$时，
        \begin{align*}
          \sum \limits_{l = 1}^r \sum\limits_{k = 1}^r a_{lk}b_{kl} = \sum \limits_{l = 1}^r \sum\limits_{k = 1}^r b_{lk}a_{kl}
        \end{align*}
        等式成立。

        $n = r + 1$时，我们有
        \begin{align*}
          \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} a_{lk}b_{kl}
          & = \sum \limits_{l = 1}^r \sum\limits_{k = 1}^r a_{lk}b_{kl} 
          + \sum \limits_{l = 1}^{r + 1} a_{l(r + 1)}b_{(r+1)l}
          + \sum \limits_{k = 1}^{r} a_{(r + 1)k} b_{k(r + 1)}
        \end{align*}
        同理，我们有
        \begin{align*}
          \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} b_{lk}a_{kl}
          & = \sum \limits_{l = 1}^r \sum\limits_{k = 1}^r b_{lk}a_{kl} 
          + \sum \limits_{l = 1}^{r + 1} b_{l(r + 1)}a_{(r+1)l}
          + \sum \limits_{k = 1}^{r} b_{(r + 1)k} a_{k(r + 1)}
        \end{align*}
        由于求和符号的下标不依赖于具体的字母，
        于是我们有
        \begin{align*}
          \sum \limits_{l = 1}^{r + 1} a_{l(r + 1)}b_{(r+1)l} - \sum \limits_{k = 1}^{r} b_{(r + 1)k} a_{k(r + 1)}
          & = \sum \limits_{l = 1}^{r + 1} a_{l(r + 1)}b_{(r+1)l} - \sum \limits_{l = 1}^{r} b_{(r + 1)l} a_{l(r + 1)} \\
          & = a_{(r + 1)(r + 1)}b_{(r + 1)(r + 1)}
        \end{align*}
        同理
        \begin{align*}
          \sum \limits_{l = 1}^{r} a_{(r + 1)l} b_{l(r + 1)} - \sum \limits_{l = 1}^{r + 1} b_{l(r + 1)}a_{(r+1)l}
          & = - a_{(r + 1)(r + 1)}b_{(r + 1)(r + 1)}
        \end{align*}
        结合归纳假设可知
        \begin{align*}
          \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} a_{lk}b_{kl} 
          -  \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} b_{lk}a_{kl} = 0 \\
          \implies \\
          \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} a_{lk}b_{kl} 
          =  \sum \limits_{l = 1}^{r + 1} \sum\limits_{k = 1}^{r + 1} b_{lk}a_{kl}
        \end{align*}

        归纳完成。

        所以，$Tr(AB) = Tr(BA)$。

  \item (2)

        设$A$为任意$n$阶方阵
        \begin{align*}
          A = \begin{bmatrix}
                a_{11} & a_{12} & \cdots & a_{1n} \\
                a_{21} & a_{22} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                a_{n1} & a_{n2} & \cdots & a_{nn}
              \end{bmatrix}
        \end{align*}
        我们有
        \begin{align*}
          Tr(AA^T) & = (a_{11}^2 + a_{12}^2 + \cdots + a_{1n}^2) \\
                   & + (a_{21}^2 + a_{22}^2 + \cdots + a_{2n}^2) \\
                   & + \cdots                                    \\
                   & + (a_{n1}^2 + a_{n2}^2 + \cdots + a_{nn}^2) \\
        \end{align*}
        因为$A$是$\mathbb{R}$上的矩阵，所以
        \begin{align*}
          Tr(AA^T) \geq 0
        \end{align*}

        后一部分的证明略。

  \item (3)

        我们有
        \begin{align*}
           & Tr[(AB - BA)(BA - AB)]                      \\
           & = Tr(ABBA - ABAB - BABA + BAAB)             \\
           & = Tr(ABBA) - Tr(ABAB) - Tr(BABA) + Tr(BAAB)
        \end{align*}
        利用(1)，我们有
        \begin{align*}
           & Tr(ABBA) - Tr(ABAB) - Tr(BABA) + Tr(BAAB)   \\
           & = Tr(AABB) - Tr(ABAB) - Tr(ABAB) + Tr(AABB)
        \end{align*}
        又因为
        \begin{align*}
          (AB - BA)^T = BA - AB
        \end{align*}
        利用(2)可得
        \begin{align*}
          Tr(AABB) - Tr(ABAB) - Tr(ABAB) + Tr(AABB) \geq 0 \\
          Tr(AABB) + Tr(AABB) \geq Tr(ABAB) + Tr(ABAB)     \\
          2 Tr(AABB) \geq 2 Tr(ABAB)                       \\
          Tr(A^2B^2) \geq Tr[(AB)^2]
        \end{align*}
\end{itemize}

\end{document}
